from Crypto.Util.number import long_to_bytes

p = 8889057433391366636555132013845575803115434268445199058885925087637422297496531774188437232818741124827270449235232786892369018597850022083170712847815469
q = 11187043287688672243244492903109608907521073741817611510285528859192365116674786455232823925077638278751851586714897710076741960162900737976850517486816617

def mod_sqrt(c, n):
    # Find the prime factors p and q of n
    # Calculate the modular square roots of c modulo p and q
    roots_p = mod_sqrt_prime(c, p)
    roots_q = mod_sqrt_prime(c, q)
    # Combine the modular square roots modulo p and q to obtain the modular square roots modulo n
    roots = []
    for i in roots_p:
        for j in roots_q:
            x = crt(i, j, p, q)
            roots.append(x)
            roots.append(n-x)
    return sorted(set(roots))


def mod_sqrt_prime(c, p):
    # Calculate the Legendre symbol of c modulo p
    ls = pow(c, (p-1)//2, p)
    # Check if c is a quadratic residue modulo p
    if ls != 1:
        raise ValueError("c is not a quadratic residue modulo p")
    # Calculate the modular square roots of c modulo p using the Tonelli-Shanks algorithm
    q = p-1
    s = 0
    while q % 2 == 0:
        q //= 2
        s += 1
    if s == 1:
        return pow(c, (p+1)//4, p), pow(-c, (p+1)//4, p)
    z = 2
    while pow(z, (p-1)//2, p) != p-1:
        z += 1
    c1 = pow(c, q, p)
    t = pow(c, (q+1)//2, p)
    r = pow(z, q, p)
    m = s
    while True:
        if c1 == 1:
            return t, p-t
        i = 0
        ci = c1
        while ci != 1 and i < m-1:
            ci = (ci*ci) % p
            i += 1
        b = pow(r, 1<<(m-i-1), p)
        t = (t*b) % p
        r = (b*b) % p
        c1 = (c1*r) % p
        m = i

def crt(a, b, p, q):
    # Calculate the modular inverse of p modulo q and q modulo p
    inv_p = pow(p, q-2, q)
    inv_q = pow(q, p-2, p)
    # Use the Chinese Remainder Theorem to combine a modulo p and b modulo q into x modulo pq
    x = (a*q*inv_q + b*p*inv_p) % (p*q)
    return x

n = 99442270294099984898212625417119632638303109926788961255288588823999039524347962038420336592870463642139410100619857267221960431755958783001805541805108899222088729651628757814664913836559145835673371525979984324756888330368365659500918533214827652263418375144731716546753138925907808652195275299435458848373
at = 55689415805610535421089465274902881709683149869115473544301340514136920392776100843578107899166726151366321155626012672258305364569648718053531633419642605921947375238632580642049198686212537310413943227922789160197161624403941525620553899115713003835382221890250799618890442747310878188477952361598650567105
bt = 33836237847761341651003311904505863464959839264710837069564616369183199687381217366465302464117505060103396752900989546709483058695368332196505783591474272714975713847262438673163432318164853378821444521390238024871874673963441587377065376972474609446846440939337620982369413651008493404419923041536483855003
ct = 65606032446338643247209313512613769173343270662078124185723972454815839836966744671955034128752958582036013347718867720512477373060590450805299758213634626507113015804366319141501481518394292456851927004589746299885013656404924072123853156242353042816571934205394095564383725274899315247775352257898974993370
dt = 43752854488489449477123160142216750928619960057673487710987248309862119131571861194842228693703737490773088944993844594963655067186310064948273908385466293300141354412996177172615715150346608525259428298057195164559726705964424133880364634099114648428036153254480916927862696178596930463717322937836808281268
ctx = 59998822931617132143230850415304140026054750719782232307004829752027826858220914197531496373057898439541725564213767308294102399978767428874622979135510623428553276859277236370945473137387741584776487182904060227770173056560509428314393312274505974725090655386993081488436725898771706641720638529565782504093


def decrypter(solution, i):
    # 1337 = 600 + 600 + 137 
    if i < 137:
        for sol in solution:
            try:
                solved = mod_sqrt(sol, n)
                decrypter(solved, i+1)
            except:
                pass
    else:
        for sol in solution:
            if sol not in output:
                output.append(sol)


# Deler opp for å unngå stack overflow
# i < 600
result = [4609165705707582462097624163179411517091621599567421755076893189995113601013205430265810627479994205490876970051472843605620159376170019375820126828408419102450408075535129957002924687786942278934004123495894343586179262892739860669943393006820446777530054661806265144368685878523679483505516375591560161116, 8328542248093817852423499337601631155413503442788561719512141816078873068723777932125679216861267263438352472635674745925939247665420676486182489798758192318436559796571283506139451490339037427933218988453563312568736583717536639821821944395494141975280365600533171198238908936143141713822410948887518006032, 91113728046006167045789126079518001482889606484000399535776447007920166455624184106294657376009196378701057627984182521296021184090538106515623052006350706903652169855057474308525462346220108407740152537526421012188151746650829019679096588819333510288138009544198545348514229989764666938372864350547940842341, 94833104588392402436115001253940221121211488327221539500211695634003925923334756608154525965390469436648533130568384423616340272379788763625985414976700480119638321576093627857661989148772203556739367402484089981170709067475625798830975140208007205485888320482925451402384453047384129168689758923843898687257, 5158775708250088527445903898228106492110111979938098508551123726154710308177604501922236853802592126745251825618809041026387664604453117137615587292714602318927747459301680122336930687571671974408606147739183910335311134183339274803737976305675515791668496020831177044112957309860622737322035990188301750148, 7778932245551311787075219602552936180395013062417884966037911279919276361559378860469252990538669342183977617068338548505171742437137578724387029334452009101959220412804733340805445490554307732458616964210273745819604712426937225688027361096639072961141924241508259298494637504806198460005891334290776417000, 91663338048548673111137405814566696457908096864371076289250677544079763162788583177951083602331794299955432483551518718716788689318821204277418512470656890120129509238824024473859468346004838103214754561769710578937283617941428433812891172118188579302276450903223457248258501421101610192189383965144682431373, 94283494585849896370766721518891526146192997946850862746737465097844329216170357536498099739067871515394158275001048226195572767151505665864189954512394296903160982192327077692327983148987473861264765378240800414421577196185026384697180556909152136471749879123900539502640181616047185914873239309247157098225, 3870488277109538393115792822598567304228257688881280858784506304427529559002794761190377387033841280827153115929496173437483287656477304954684672014832037399405809898969471037462407375820910495036691326644523557890229749319543666893851429554008181238927273850487606907555498142113375920461330604619632335609, 7589864819495773783441667997020786942550139532102420823219754930511289026713367263050245976415114338774628618513698075757802375945727962065047034985181810615391961620005624586598934178373005644035906191602192526872787070144340446045729980942681876436677584789214512961425721199732838150778225177915590180525, 91852405474604211114770957420098845695752970394686540432068833893487750497634594775370090616455349303364781482106159191464158055810230820936758506819927088606696768031623133228065979658186140191637465334377791797884101260224025213455188552272145775826740790355517203585327417726174970501417050121519868667848, 95571782016990446505096832594521065334074852237907680396504082519571509965345167277229959205836622361312256984690361093784477144099481478047120869790276861822682919752659286777202506460738235340636680199335460766866658581048821992607067103660819471024491101294244109639197640783794432731733944694815826512764, 4420098279652044458464072557647262279246748069251957612258736840587126266167193832846803613356439202081527971496832370858250792884760402716480132479138220615883149282736021202796413375605640190511293350887813124639361620610143081027646012852863250253065715209512518807299769573450319174277850219216373924641, 7040254816953267718093388261972091967531649151731744069745524394351692319548968191393819750092516417520253762946361878337034870717444864303251574520875627398914622236239074421264928178588275948561304167358902960123655198853741031911935397643826807422539143430189601061681449768395894896961705563318848591493, 92402015477146717180119237155147540670771460775057217185543064429647347204798993847026516842777947224619156337673495388884925561038513918698553967284233271823174107415389683393399985657970869887112067358621081364633233131514624627588983135571000844840879231714542115485071689157511913755233569736116610256880, 95022172014447940439748552859472370359056361857537003643029851983411913258180768205573532979514024440057882129123024896363709638871198380285325409325970678606205580368892736611868500460953505645162078175092171200117526709758222578473272520361964402010352659935219197739453369352457489477917425080219084923732, 30873289294172115315911372639328715179008648315126824445532569787140220158307574483131992383795510587569685404061860798191405678913946460994876628253252127421020779906412962063266868136737849738103046320292077756225114383553184350762990638724465309826856105177520075632611163085913154481323358580771054156954, 43810997247973515630432496140109757851513773357482807920121604793214206828044557845523482228136772056498914846749008387722965085955537156856879244880418738841907747778519375526409244314863829444970269432241535412380030230163460851254755976126779898579666525439859511975218757900579975678651285905250132324102, 55631273046126469267780129277009874786789336569306153335166984030784832696303404192896854364733691585640495253870848879498995345800421626144926296924690160380180981873109382288255669521695316390703102093738448912376858100204904808246162557088047753683751849704872204571534381025327832973543989394185326524271, 68568980999927869582301252777790917459294461611662136809756019036858819366040387555288344209074953054569724696557996469030554752842012322006928913551856771801067949745215795751398045699821296097570325205687906568531773946815181308737927894490362342436562269967211640914141975839994654170871916718664404691419, 41018410762361770169901533256732632250315382891984996350007507026799740132552339707949709233843752839959911433986294076906225419603626081871349664475281541594772983167067409605291548010351142672722216947307188872815966508623403320264608506653450018688595253673435309353350697024994719174453446635593982457874, 45486151577936814413789968659605957715482601992447981430692046791125312722058638968079137514685449333250269223946415600784175605110742005268453260702660746206428778612454934746230989648082023456083931466723337795786005975134685838744544689159063044822012701208956970850794847086246268280413901339362398223351, 53956118716163170484422656757513674922820507934340979824596542032873726802289323070341199078185014308889140876673441666437784826645216777733352281102448153015659951039173823068433924188477122379589440059256646528970882355233679820756373844055764607441405673935774745695958291839661540371781373960073060625022, 58423859531738214728311092160387000387987727034803964905281081797199299391795622330470627359026710802179498666633563190315735012152332701130455877329827357627315746484561348209373365826208003162951154578672795451940921821744962339236310026561377633574823121471296407193402441900913089477741828663841476390499, 31611966722770159384893203979909559391872012225812965341824956672707804200317985152207425624241663512233409258183837468359542550633639175416012083066828509124065378082978620982807385448703881522000359117143448541921063897126380544539082602177277575365458885988838733869424350822323458044367544351742981982461, 43072319819375471561450664799528913638650409446796667023829217907646622786034147176448048987690619131835190992627031717554828214235844442435743790066842357138863149601953716606868727002897797661072956635390164626684080716590264657478664012673967633041063744628540853738405570164169672115607100134278204498595, 56369950474724513336761960617590718999652700479992294231459370916352416738313814861972287605179844510304219107992825549667132217520114340566061751738266542083225580049675041207796186833661348174600414890589819698072807613778101002022254520540860019222354630516190862808347568761738136536588175165157254349778, 67830303571329825513319421437210073246431097700975995913463632151291235324029976886212910968628800129906000842436019798862417881122319607585793458738280390098023351568650136831857528387855264313673012408836535782835824433241985114961835931037550076897959489155892982677328788103584350607827730947692476865912, 41757088190959814238883364597313476463178746802671137246299893912367324174562750377025142474289905764623635288108270747074362291323318796292485119288857923297817581343633068524832065322317174456619529744158559658511916022196599514040700470106262284227198034484753967590163884761405022737497632406565910283381, 46224829006534858482771800000186801928345965903134122326984433676692896764069049637154570755131602257913993078068392270952312476830434719689588715516237127909473376789020593665771506960048055239981244263574708581481955488707882032520636652611875310360615482020275629087608034822656571843458087110334326048858, 53217441287565126415440825416932830709957144023654838928304155147306142760278912401265765837738861384225417022551464996269647954925524063312216826288871771312615352862608164148893406876511090595692127262405275743274932841660483626980281880602952341902802893124456087459145104103251236808737188189101132799515, 57685182103140170659329260819806156175124363124117824008988694911631715349785211661395194118580557877515774812511586520147598140432639986709320422516250975924271148307995689289832848514241971379053841781821424666244972308171766145460218063108565368036220340659977748956589254164502785914697642892869548564992]
# i < 600
result1= [25114981486496303529583696061569398728694923130670600259168134838399538388668629543789987836696315756344528898200572325635563525079298855596089777997715855070910371014053812923621122482270320377244760310601275012713257502869564786766781709271153861144401210959722600376926129037935599302583803701849789391285, 37266882728819896865247684847063462159466625039420826539309566741711996865886920556251791846029069498656766631633715002627894438059871897077466874127161380482792378910348224472358299437017900164215850265728524283485703773769777052950797562326968255376133916490069455788600725459440754067429168090975797040514, 62175387565280088032964940570056170478836484887368134715979022082287042658461041482168544746841394143482643468986142264594065993696086885924338667677947518739296350741280533342306614399541245671457521260251460041271184556598588606550120970887859396887284458654662260758152413466467054584766107208459661807859, 74327288807603681368628929355550233909608186796118360996120453985599501135679332494630348756174147885794881202419284941586396906676659927405715763807393044151178358637574944891043791354288825458428611215378709312043630827498800872734136823943673791119017164185009116169827009887972209349611471597585669457088, 23335901964827752120642077868891448944587378342613207472414990472721873966467016953097393317402854627122915888072130196993896258931925882841258229728275389205024412346561526551214879476329012336943746397148018227979547720169013141535520374767528309001911032420827932383991369984302991851763729580833709058718, 35487803207151345456306066654385512375359080251363433752556422376034332443685307965559197326735608369435153621505272873986227171912498924322635325857720914616906420242855938099952056431076592123914836352275267498751993991069225407719536227823342703233643737951174787795665966405808146616609093969959716707947, 63954467086948639441906558762734120262944029675425527502732166447964707080662654072861139266134855272704256479114584393235733259843459858679170215947387984605182309408772819714712857405482553711758535173704716826004894339299140251781382305391484949029774637193556928751087172520099662035586181329475742140426, 76106368329272232777570547548228183693715731584175753782873598351277165557880945085322943275467609015016494212547727070228064172824032900160547312076833510017064317305067231263450034360230133498729625128831966096777340610199352517965398158447299343261507342723903784162761768941604816800431545718601749789655, 28090576541160861698827191102514866293298080259350899458319477766222573947094465106145498047498382426470829035761803272975029629297415549897087475840842472981939187314473904323355381067287476657883550772196905128523503394019976072846266358784623713683355420905482298133757331109429669398269577554704423612087, 34291287674155338696004189806117994594863467910740527340158223813888961307461084993896281635227002828530466494072484055288428333841755202776469176284034762571763562609928133072624040852000743883577059804132894167675457882619365766871312912813498402837179706544309758031769523387946683971743394238121162819712, 65150982619944646202208435611001638043439642016048433915130365010110078216886877044524054957643460813608943606547373211933532097914203580225336365521074136650325167041700624742040872984558401952096311721847090157081430447748999892629605620401329249426238668600421958514983615537961124680451881061314296028661, 71351693752939123199385434314604766345005029667438061796969111057776465577253496932274838545372081215668581064858053994246930802458543233104718065964266426240149542337154853491309532769271669177789820753783079196233384936348389586654652174430203938580062954239249418412995807816478139253925697744731035236286, 26311497019492310289885572909836916509190535471293506671566333400544909524892852515452903528204921297249216025633361144333362363150042577142255927571402007116053228646981617950949138061346168617582536858743648343789793611319424427615005024280998161540865242366587630140822572055797061947449503433688343279520, 32512208152486787287062571613440044810755923122683134553405079448211296885259472403203687115933541699308853483944041926646761067694382230021637628014594296705877603942435846700217797846059435843276045890679637382941748099918814121640051578309872850694689528005415090038834764334314076520923320117105082487145, 66930062141613197611150053803679587827547186804105826701883509375787742639088489635216649476936921942830556616675815340575199364061576552980167913790514602516211125709192911114447115990499709992397325635300346941815140230449551537860866954904954801568728847139316626507918374591593732131271955182330376361228, 73130773274607674608327052507282716129112574455495454583722255423454129999455109522967433064665542344890194074986496122888598068605916205859549614233706892106035501004647139863715775775212977218090834667236335980967094719048941231885913508933829490722553132778144086405930566870110746704745771865747115568853, 5978291711905092561882946904754883099915666771747291211972920548776442595949952232522271057379622431787066889995419848135063538817682408467648058100969729062951246294419506363098597027084031620306393193662947637080229893898372216553069628210517218134753091619115837831184070388909055820967926939016973375274, 12179002844899569559059945608358011401481054423136919093811666596442829956316572120273054645108242833846704348306100630448462243362022061347029758544162018652775621589873735112367256811797298845999902225598936676232184382497761910578116182239391907288577377257943297729196262667426070394441743622433712582899, 87263267449200415339152679808761621236822055503652042161476922227556209568031389918147281947762220808292705752313756636773498188393936721654775783260946880569313108061755022702297657024761846989673469300381047648524703947870603748922802350975435744974840997886788418817556876258481738257753531677001746265474, 93463978582194892336329678512364749538387443155041670043315668275222596928398009805898065535490841210352343210624437419086896892938276374534157483704139170159137483357209251451566316809475114215366978332317036687676658436469993442947848905004310434128665283525615878715569068536998752831227348360418485473099, 3002696657240534392639451863809415535312509643066992012821577620953407037524116670166760846577555761660766752434188900795597434599565714166650360257843111151922429993999414963364338442066875339667602732067317521269984002747960930473584978697047365595798881673356140074352868317414985725282153086162339154472, 15154597899564127728303440649303478966084211551817218292963009524265865514742407682628564855910309503973004485867331577787928347580138755648027456387288636563804437890293826512101515396814455126638692687194566792042430273648173196657600831752861759827531587203702995486027464738920140490127517475288346803701, 84287672394535857169909184767816153672218898374971742962325579299733174009605554355791771736960154138166405614752525689434032084175820027353778085417820262658284291761334931302563398439744690709034678838785417532714458056720192462843317701461965892435886787941028721060725674186987668162067757824147112044672, 96439573636859450505573173553310217102990600283721969242467011203045632486823845368253575746292907880478643348185668366426362997156393068835155181547265788070166299657629342851300575394492270496005768793912666803486904327620404729027333554517780286667619493471375576472400270608492822926913122213273119693901, 33526816181607847731049430548385445894894318910925965103421059821405010247873537179537592337803542901597544449130881589788291674131852343231974953189266161687912162034292139119525041315563236373570438767141070568304816163880331108541753795582297599197731401133417130899110175121098148069008923643282714231104, 39727527314602324728226429251988574196459706562315592985259805869071397608240157067288375925532163303657181907441562372101690378676191996111356653632458451277736537329746367868793701100276503599263947799077059607456770652479720802566800349611172288351555686772244590797122367399615162642482740326699453438729, 59714742979497660169986196165131058441843403364473368270028782954927641916107804971131960667338300338482228193178294895120270053079766786890448888172650447944352192321882389945871212736282642236409423726902924717300117677888644856934118183603655363911862688372487125749630771526292646009712534972736005409644, 65915454112492137167163194868734186743408791015862996151867529002594029276474424858882744255066920740541865651488975677433668757624106439769830588615842737534176567617336618695139872520995909462102932758838913756452072166488034550959164737632530053065686974011314585647642963804809660583186351656152744617269, 30551221126943289561805935507439978330291161782245665904269716893581974689447701617182082127001476231471244311569650642448825569913735648930977255346139543776883345733872047719790782730546080092931648305545440452494570272729919822462269146068827746658777191187657433142278973049604077973323149790428080010302, 42703122369266882897469924292934041761062863690995892184411148796894433166665992629643886136334229973783482045002793319441156482894308690412354351475585069188765353630166459268527959685293659879902738260672689723267016543630132088646284999124642140890509896718004288553953569471109232738168514179554087659531, 56739147924833102000742701124185590877240246235793069070877440027104606357681969408776450456536233668355928055617063947780803948861650092589451190329523830033323376021462298546136954151265485955770633265307294601489871786738233570854633534090185511372908478426727427992799569454798575914026761119881371188842, 68891049167156695336406689909679654308011948144543295351018871930417064834900260421238254465868987410668165789050206624773134861842223134070828286458969355445205383917756710094874131106013065742741723220434543872262318057638445837038649387145999905604641183957074283404474165876303730678872125509007378838071]
# i < 137


output = []
decrypter(result1, 0)

print("\n\nFinished!")
print(output)
for x in output: print("\n", long_to_bytes(x))